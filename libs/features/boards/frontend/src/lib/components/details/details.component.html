<div class="vertical-align-baseline details-wrapper">
  <p-accordion [multiple]="true">
    <p-accordionTab header="Map and Products" [selected]="true">
      <petrologistic-maps
        [deliveriesCoordinates]="selectedCoordinates"
        (approxDrivingDistanceEvent)="onDistanceCalculated($event)"
        (approxDrivingTimeEvent)="onDurationCalculated($event)"
      ></petrologistic-maps>
      <div class="flex justify-content-between flex-wrap metric">
        <table>
          <tr>
            <th>
              <p-tag severity="success"><i class="pi pi-clock"></i></p-tag>
            </th>
            <th style="color: rgb(167, 167, 167)">Driving Time</th>
          </tr>
          <td></td>
          <td>
            {{ approxDrivingDuration === '' ? '-' : approxDrivingDuration }}
          </td>
        </table>
        <table>
          <tr>
            <th>
              <p-tag severity="info"><i class="pi pi-car"></i></p-tag>
            </th>
            <th style="color: rgb(167, 167, 167)">Driving Distance</th>
          </tr>
          <td></td>
          <td>
            {{
              approxDrivingDistance === 0
                ? '-'
                : (approxDrivingDistance | number: '1.0-2') + 'Km'
            }}
          </td>
        </table>
        <table>
          <tr>
            <th>
              <p-tag severity="warning"
                ><i class="pi pi-align-justify"></i
              ></p-tag>
            </th>
            <th style="color: rgb(167, 167, 167); text-align: left">
              Selected
            </th>
          </tr>
          <td></td>
          <td>{{ selectedRequestsCount }} Req(s)</td>
        </table>
      </div>
      <div class="card">
        <p-chart
          type="bar"
          [data]="basicData"
          [options]="horizontalOptions"
        ></p-chart>
      </div>
    </p-accordionTab>
    <p-accordionTab
      *ngFor="let request of selectedDeliveryRequests; let i = index"
      header="Ticket: {{ request.purchaseOrder }}"
      [selected]="i === 0"
    >
      <table>
        <tr valign="top">
          <td rowspan="2">
            <div>
              <img
                style="margin-right: 10px"
                src="assets/logo-placeholder.png"
                alt="company-logo"
                width="60px"
                height="60px"
              />
            </div>
          </td>
          <td colspan="2">
            <strong>{{ request.shipToAccount.name }}</strong>
            <br />
            <sub>
              {{ request.shipToAccount.address.addressLine1 }},
              {{ request.shipToAccount.address.city }},
              {{ request.shipToAccount.address.province }},
              {{ request.shipToAccount.address.postalCode }}
            </sub>
          </td>
        </tr>
      </table>
      <table style="width: 100%">
        <tr>
          <td>
            <i class="pi pi-user mr-2"> Primary Contact </i>
          </td>
          <td>
            <i class="pi pi-phone mr-2">
              {{ request.shipToAccount.phoneNumber }}</i
            >
          </td>
        </tr>
        <tr>
          <td>
            <i class="pi pi-envelope mr-2"> emain@company.com</i>
          </td>
        </tr>
      </table>
      <p-divider align="left" type="dashed">
        <div class="inline-flex align-items-center">
          <i class="pi pi-clone mr-2"></i>
          Containers
        </div>
      </p-divider>
      <div
        *ngFor="let container of request.destinationContainers; let j = index"
        class="container-fieldset"
      >
        <p-fieldset
          legend="Container {{ container.id.toString().slice(0, 5) }}"
          [toggleable]="true"
          [collapsed]="j != 0"
        >
          <div class="fieldset-content">
            <p-knob
              class="container-knob"
              [(ngModel)]="container.currentPercentage"
              [valueColor]="
                container.currentPercentage < 15
                  ? '#DF0404'
                  : '#3C82F6'
              "
            ></p-knob>
            <table>
              <tr>
                <td colspan="2">Tank #</td>
                <td>884</td>
              </tr>
              <tr>
                <td colspan="2">Requested</td>
                <td>
                  {{ container.requestedAmount }}
                  {{ container.requestedAmountUnit }}
                </td>
              </tr>
              <tr>
                <td colspan="2">Product</td>
                <td>{{ container.product.description }}</td>
              </tr>
              <tr>
                <td colspan="2">License Expiry</td>
                <td>11/17/2023</td>
              </tr>
              <tr>
                <td colspan="2">Barcode</td>
                <td>A1B2C3</td>
              </tr>
              <tr>
                <td colspan="2">Price No UnitTax</td>
                <td>1.45</td>
              </tr>
              <tr>
                <td colspan="2">Excise Tax</td>
                <td>0.05</td>
              </tr>
              <tr>
                <td colspan="2">Carbon Tax</td>
                <td>0.1</td>
              </tr>
              <tr>
                <td colspan="2">Net Price</td>
                <td>1.60</td>
              </tr>
              <tr>
                <td colspan="2">S/N</td>
                <td>a6s5d4as65d4as6d54as6d</td>
              </tr>
            </table>
          </div>
        </p-fieldset>
      </div>
      <p-divider align="left" type="dashed">
        <div class="inline-flex align-items-center">
          <i class="pi pi-exclamation-circle mr-2"></i>
          Instructions
        </div>
      </p-divider>
      <div>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      </div>
    </p-accordionTab>
  </p-accordion>
</div>
